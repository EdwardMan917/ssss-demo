import{j as E,k as z,l as D,m as g,o as x,a as q,c as N,d as k,n as $,q as j,v as T,x as A,_ as F,u as R,s as I,r as U,b as d,t as O,e as G,w as K,T as C,f as Y,p as V,g as H}from"./index.a778663a.js";Object.freeze({__proto__:null});var L={library:"https://accounts.google.com/gsi/client",defaultButtonConfig:{theme:"outline",size:"large"},scopes:"email profile openid"};const f=E({clientId:null,popupType:"CODE",prompt:!1,autoLogin:!1,idConfiguration:null,buttonConfig:L.defaultButtonConfig,callback:()=>{},error:null}),h=E({apiLoaded:!1,apiLoadIntitited:!1}),M=new Promise(e=>{const n=typeof window<"u";if(!h.apiLoadIntitited&&n){const i=document.createElement("script");h.apiLoadIntitited=!0,i.addEventListener("load",()=>{h.apiLoaded=!0,e(window.google)}),i.src=L.library,i.async=!0,i.defer=!0,document.head.appendChild(i)}}),b=e=>{h.apiLoadIntitited?h.apiLoaded?e(window.google):A(()=>h.apiLoaded,n=>{n&&e(window.google)}):M.then(n=>{e(n)})},J=(e,n,i,o)=>{if(!e.client_id)throw new Error("Prop client id required since plugin is not initialized with a client id");b(()=>{((t,p,l,s,a)=>{if(a){const w=t.callback;t.callback=m=>{m.credential?w&&w(m):a(m)}}window.google.accounts.id.initialize(t);const c=p.value;c&&!s&&window.google.accounts.id.renderButton(c,l)})(e,n,i.buttonConfig,o,i.error),i.prompt&&X({clientId:i.clientId,callback:i.callback,error:i.error,autoLogin:i.autoLogin})})},Q=e=>new Promise((n,i)=>{b(o=>{if(!(e&&e.clientId||f.clientId))throw new Error("clientId is required since the plugin is not initialized with a Client Id");o.accounts.oauth2.initCodeClient({client_id:e&&e.clientId||f.clientId||"",scope:L.scopes,ux_mode:"popup",callback:t=>{t.code?n(t):i(t)}}).requestCode()})}),W=e=>new Promise((n,i)=>{b(o=>{if(!(e&&e.clientId||f.clientId))throw new Error("clientId is required since the plugin is not initialized with a Client Id");o.accounts.oauth2.initTokenClient({client_id:e&&e.clientId||f.clientId||"",scope:L.scopes,callback:t=>{t.access_token?n(t):i(t)}}).requestAccessToken()})}),X=e=>{if(!e&&(e={}),!e.clientId&&!f.clientId)throw new Error("clientId is required");const n={};return e.clientId&&(n.client_id=e.clientId),!e.clientId&&f.clientId&&(n.client_id=f.clientId),e.context&&(n.context=e.context),e.autoLogin!=null&&(n.auto_select=e.autoLogin),e.cancelOnTapOutside!=null&&(n.cancel_on_tap_outside=e.cancelOnTapOutside),new Promise((i,o)=>{n.callback=t=>{e&&e.callback&&e.callback(t),t.credential?i(t):o(t)},b(t=>{t.accounts.id.initialize(n),t.accounts.id.prompt(p=>{e&&e.onNotification&&e.onNotification(p),(l=>{const s=l.notification;let a="";s.isNotDisplayed()&&(a=s.getNotDisplayedReason()==="suppressed_by_user"?"Prompt was suppressed by user'. Refer https://developers.google.com/identity/gsi/web/guides/features#exponential_cooldown for more info":`Prompt was not displayed, reason for not displaying: ${s.getNotDisplayedReason()}`),s.isSkippedMoment()&&(a=`Prompt was skipped, reason for skipping: ${s.getSkippedReason()}`),a.length&&(l.error?l.error(a):l.reject(a))})({notification:p,reject:o,error:e&&e.error})})})})};var P=z({name:"GoogleLogin",props:{clientId:{type:String,required:!1},prompt:{type:Boolean,required:!1,default:!1},autoLogin:{type:Boolean,required:!1,default:!1},popupType:{type:String,required:!1,default:"CODE"},idConfiguration:{type:Object,required:!1},buttonConfig:{type:Object,required:!1},callback:{type:Function,required:!1},error:{type:Function,required:!1}},setup(e){const n=e,i=!!D().default,o=((l,s)=>{const a={...l};for(const c in s)s[c]!==void 0&&s[c]!==null&&(a[c]=s[c]);return a})(f,n),t={client_id:o.clientId||null,auto_select:o.autoLogin||!1,callback:o.callback,...o.idConfiguration},p=g();return x(()=>{J(t,p,o,i)}),(l,s)=>(q(),N("div",{class:T(["g-btn-wrapper",[!k(h).apiLoaded&&"api-loading"]]),onClick:s[0]||(s[0]=a=>k(i)&&void(k(o).popupType==="TOKEN"?W({clientId:o.clientId}).then(c=>{o.callback&&o.callback(c)}):Q({clientId:o.clientId}).then(c=>{o.callback&&o.callback(c)})))},[k(i)?$("v-if",!0):(q(),N("span",{key:0,ref_key:"buttonRef",ref:p,class:"g-btn"},null,512)),j(l.$slots,"default")],2))}});(function(e,n){n===void 0&&(n={});var i=n.insertAt;if(e&&typeof document<"u"){var o=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",i==="top"&&o.firstChild?o.insertBefore(t,o.firstChild):o.appendChild(t),t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}})(`
.g-btn-wrapper[data-v-5e610566] {
  display: inline-block;
}
.g-btn-wrapper.api-loading[data-v-5e610566] {
  opacity: 0.5;
  pointer-events: none;
}
`),P.__scopeId="data-v-5e610566",P.__file="src/plugin/GoogleLogin.vue";const Z="/ssss-demo/assets/googledrive.c279ba87.svg",ee="/ssss-demo/assets/upload.f2a70acf.svg";const v=e=>(V("data-v-d11f0415"),e=e(),H(),e),te={class:"main"},oe=v(()=>d("div",{class:"description"}," Your passphrase is stored securely in a distributed manner. Please follow the steps below and click done to complete ",-1)),ne={class:"upload-section"},ie=v(()=>d("div",{class:"title"},"Step 1",-1)),se=v(()=>d("div",{class:"content"}," Store the first part of your passphrase secret in your preferred cloud storage. ",-1)),ae=v(()=>d("div",{class:"content"}," No one can recover the passphrase with only this file. ",-1)),le=["src"],ce={class:"upload-section"},de=v(()=>d("div",{class:"title"},"Step 2",-1)),re=v(()=>d("div",{class:"content"}," Encrypt second part of your passphrase secret with FaceID. ",-1)),pe=v(()=>d("div",{class:"content"}," The file can only be opened with FaceID. ",-1)),ue=["src"],ge={__name:"UploadKey",setup(e){const n=R(),i=g(Z),o=g(ee),t=g(!1),p=g("Incomplete"),l=g(!1),s=g("Incomplete"),a=g(""),c=u=>{a.value==""?w(I.keyParts[u],u):m(I.keyParts[u],u)},w=(u,r)=>{b(_=>{_.accounts.oauth2.initTokenClient({client_id:"224572308047-7nhsugkrdnofunvmopjm4r2uirttu4fl.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/drive openid",callback:y=>{a.value=y.access_token,m(I.keyParts[r],r)}}).requestAccessToken()})},m=(u,r)=>{C.loading({message:"Loading...",forbidClick:!0});let _=new Headers;_.append("Authorization",`Bearer ${a.value}`),_.append("Content-Type","multipart/related; boundary=bOuNdArYsTrInG");let y=`
--bOuNdArYsTrInG
Content-Type: application/json; charset=UTF-8

{
  "name": "keypart_${r+1}.txt"
}

--bOuNdArYsTrInG
Content-Type: text/plain

${u}

--bOuNdArYsTrInG--
`;fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:_,body:y,redirect:"follow"}).then(S=>{S.ok?(C.success("Success"),r==0?(t.value=!0,p.value="Completed"):(l.value=!0,s.value="Completed")):C.fail("Fail")}).catch(S=>{console.log("error",S),C.fail("Fail")})},B=()=>{n.push({path:"/ssss-demo/"})};return x(()=>{I.setPageTitle("Create Recovery Kit")}),(u,r)=>{const _=U("van-button");return q(),N("div",te,[oe,d("div",ne,[ie,se,ae,d("img",{src:i.value,onClick:r[0]||(r[0]=y=>c(0))},null,8,le),d("div",{class:T(["status",t.value?"highlight":""])},O(p.value),3)]),d("div",ce,[de,re,pe,d("img",{class:"upload",src:o.value,onClick:r[1]||(r[1]=y=>c(1))},null,8,ue),d("div",{class:T(["status",l.value?"highlight":""])},O(s.value),3)]),G(_,{class:T(["primary-btn",t.value&&l.value?"":"btn-disabled"]),disabled:!t.value||!l.value,onClick:r[2]||(r[2]=y=>B())},{default:K(()=>[Y("Done")]),_:1},8,["class","disabled"])])}}},he=F(ge,[["__scopeId","data-v-d11f0415"]]);export{he as default};
